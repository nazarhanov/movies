var E=Object.defineProperty;var m=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var d=(s,e,t)=>e in s?E(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,f=(s,e)=>{for(var t in e||(e={}))w.call(e,t)&&d(s,t,e[t]);if(m)for(var t of m(e))I.call(e,t)&&d(s,t,e[t]);return s};var c=(s,e,t)=>(d(s,typeof e!="symbol"?e+"":e,t),t);import{j as P,a as b,F as S,L as p,c as $,_ as v,p as L,R,A,S as k}from"./vendor.4f1139c9.js";const B=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}};B();const C="modulepreload",y={},O="./",T=function(e,t){return!t||t.length===0?e():Promise.all(t.map(a=>{if(a=`${O}${a}`,a in y)return;y[a]=!0;const r=a.endsWith(".css"),n=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${n}`))return;const o=document.createElement("link");if(o.rel=r?"stylesheet":C,r||(o.as="script",o.crossOrigin=""),o.href=a,document.head.appendChild(o),r)return new Promise((g,_)=>{o.addEventListener("load",g),o.addEventListener("error",_)})})).then(()=>e())};var l={GH_REPO_URL:"/movies",API_KEY:"8c8e1a50-6322-4135-8875-5d40a5420d86",API_BASE:"https://kinopoiskapiunofficial.tech"};const i=P,u=b,h=S;var j=s=>u(p,{class:$("card",{[s.class]:!!s.class}),href:s.url,children:[i("div",{class:"card-img",style:`background-image: url(${s.image})`}),i("div",{class:"card-title",children:s.title}),i("div",{class:"card-desc",children:s.description})]});class x extends v{constructor(e){super(e);c(this,"state");c(this,"refInput",L());c(this,"timeout",0);c(this,"page",1);this.state={movies:[]},this.handleInput=this.handleInput.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleInput(e){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.handleSubmit(e)},1e3)}handleSubmit(e){clearTimeout(this.timeout),e.preventDefault(),this.searchMovieByName(this.refInput.current.value)}async api(e){const t=await fetch(l.API_BASE+e,{method:"GET",headers:{"Content-Type":"application/json","X-API-KEY":l.API_KEY}});let a=null;try{if(!t.ok)throw new Error("Invalid status");let{films:r}=await t.json();a=r.map(n=>({title:n.nameRu,description:n.year,url:`/movies/${n.filmId}`,image:n.posterUrlPreview}))}catch(r){console.error(r);return}return a}async searchMovieByName(e){const t=await this.api(`/api/v2.1/films/search-by-keyword?keyword=${e}`);this.setState({movies:t}),this.page=1}async searchMovieTop(e){const t=await this.api(`/api/v2.2/films/top?type=TOP_250_BEST_FILMS&page=${e}`);return t.length?(this.setState({movies:[...this.state.movies,...t]}),!1):!0}componentDidMount(){let e=!1;const t=async()=>{await this.searchMovieTop(this.page++)||(e=!1)};window.onscroll=async a=>{e||window.innerHeight+window.scrollY>=document.body.offsetHeight-120&&(t(),e=!0)},t()}componentWillUnmount(){}render(){return u(h,{children:[i("form",{class:"home-search",onSubmit:this.handleSubmit,children:u("label",{class:"home-label",children:[i("input",{class:"home-input",type:"text",name:"search",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0444\u0438\u043B\u044C\u043C\u0430 ...",onInput:this.handleInput,ref:this.refInput}),i("svg",{class:"home-icon",width:"24",height:"24",children:i("use",{xlinkHref:"#icon-search"})})]})}),i("div",{class:"cards",children:i("div",{class:"cards-wrapper",children:this.state.movies.map(e=>i(j,f({class:"cards-item"},e)))})})]})}}class D extends v{render(){return i(h,{children:i("div",{class:"error",children:"404"})})}}function H(){return u(h,{children:[i("header",{class:"header",children:u("div",{class:"container",children:[i(p,{class:"header-logo",href:`${l.GH_REPO_URL}/`,children:"movies"}),i("div",{class:"header-desc",children:"\u0441\u043C\u043E\u0442\u0440\u0438\u0442\u0435 \u0444\u0438\u043B\u044C\u043C\u044B \u043E\u043D\u043B\u0430\u0439\u043D, \u0431\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E"})]})}),i("div",{class:"content container",children:u(R,{children:[i(x,{path:`${l.GH_REPO_URL}/`}),i(A,{path:`${l.GH_REPO_URL}/:id`,getComponent:()=>T(()=>import("./movies.6734ca41.js"),["assets/movies.6734ca41.js","assets/movies.be846550.css","assets/vendor.4f1139c9.js"]).then(s=>s.default),loading:()=>i("span",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 ..."})}),i(D,{path:"*",default:!0})]})})]})}k(i(H,{}),document.getElementById("app"));export{h as F,i as a,u as j};
