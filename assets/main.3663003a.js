var w=Object.defineProperty;var m=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var d=(r,e,t)=>e in r?w(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,f=(r,e)=>{for(var t in e||(e={}))E.call(e,t)&&d(r,t,e[t]);if(m)for(var t of m(e))I.call(e,t)&&d(r,t,e[t]);return r};var l=(r,e,t)=>(d(r,typeof e!="symbol"?e+"":e,t),t);import{j as b,a as S,F as _,L as p,c as $,_ as v,p as A,R as P,A as k,S as B}from"./vendor.4f1139c9.js";const L=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}};L();const j="modulepreload",y={},x="/",C=function(e,t){return!t||t.length===0?e():Promise.all(t.map(o=>{if(o=`${x}${o}`,o in y)return;y[o]=!0;const s=o.endsWith(".css"),n=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${n}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":j,s||(a.as="script",a.crossOrigin=""),a.href=o,document.head.appendChild(a),s)return new Promise((u,g)=>{a.addEventListener("load",u),a.addEventListener("error",g)})})).then(()=>e())};const i=b,c=S,h=_;var T=r=>c(p,{class:$("card",{[r.class]:!!r.class}),href:r.url,children:[i("div",{class:"card-img",style:`background-image: url(${r.image})`}),i("div",{class:"card-title",children:r.title}),i("div",{class:"card-desc",children:r.description})]});class D extends v{constructor(e){super(e);l(this,"state");l(this,"refInput",A());l(this,"timeout",0);l(this,"page",1);this.state={movies:[]},this.handleInput=this.handleInput.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleInput(e){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.handleSubmit(e)},1e3)}handleSubmit(e){clearTimeout(this.timeout),e.preventDefault(),this.searchMovieByName(this.refInput.current.value)}async api(e){const t="8c8e1a50-6322-4135-8875-5d40a5420d86",s=await fetch("https://kinopoiskapiunofficial.tech"+e,{method:"GET",headers:{"Content-Type":"application/json","X-API-KEY":t}});let n=null;try{if(!s.ok)throw new Error("Invalid status");let{films:a}=await s.json();n=a.map(u=>({title:u.nameRu,description:u.year,url:`/movies/${u.filmId}`,image:u.posterUrlPreview}))}catch(a){console.error(a);return}return n}async searchMovieByName(e){const t=await this.api(`/api/v2.1/films/search-by-keyword?keyword=${e}`);this.setState({movies:t}),this.page=1}async searchMovieTop(e){const t=await this.api(`/api/v2.2/films/top?type=TOP_250_BEST_FILMS&page=${e}`);return t.length?(this.setState({movies:[...this.state.movies,...t]}),!1):!0}componentDidMount(){let e=!1;const t=async()=>{await this.searchMovieTop(this.page++)||(e=!1)};window.onscroll=async o=>{e||window.innerHeight+window.scrollY>=document.body.offsetHeight-120&&(t(),e=!0)},t()}componentWillUnmount(){}render(){return c(h,{children:[i("form",{class:"home-search",onSubmit:this.handleSubmit,children:c("label",{class:"home-label",children:[i("input",{class:"home-input",type:"text",name:"search",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0444\u0438\u043B\u044C\u043C\u0430 ...",onInput:this.handleInput,ref:this.refInput}),i("svg",{class:"home-icon",width:"24",height:"24",children:i("use",{xlinkHref:"#icon-search"})})]})}),i("div",{class:"cards",children:i("div",{class:"cards-wrapper",children:this.state.movies.map(e=>i(T,f({class:"cards-item"},e)))})})]})}}class F extends v{render(){return i(h,{children:i("div",{class:"error",children:"404"})})}}function O(){return c(h,{children:[i("header",{class:"header",children:c("div",{class:"container",children:[i(p,{class:"header-logo",href:"/",children:"movies"}),i("div",{class:"header-desc",children:"\u0441\u043C\u043E\u0442\u0440\u0438\u0442\u0435 \u0444\u0438\u043B\u044C\u043C\u044B \u043E\u043D\u043B\u0430\u0439\u043D, \u0431\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E"})]})}),i("div",{class:"content container",children:c(P,{children:[i(D,{path:"/"}),i(k,{path:"/movies/:id",getComponent:()=>C(()=>import("./movies.865a68d6.js"),["assets/movies.865a68d6.js","assets/movies.be846550.css","assets/vendor.4f1139c9.js"]).then(r=>r.default),loading:()=>i("span",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 ..."})}),i(F,{path:"*",default:!0})]})})]})}B(i(O,{}),document.getElementById("app"));export{h as F,i as a,c as j};
