var _=Object.defineProperty;var f=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var d=(r,e,t)=>e in r?_(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,p=(r,e)=>{for(var t in e||(e={}))I.call(e,t)&&d(r,t,e[t]);if(f)for(var t of f(e))b.call(e,t)&&d(r,t,e[t]);return r};var c=(r,e,t)=>(d(r,typeof e!="symbol"?e+"":e,t),t);import{j as S,a as P,F as A,L as v,c as L,_ as y,p as $,R as k,A as B,S as j}from"./vendor.c8f8949d.js";const x=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}};x();const C="modulepreload",g={},R="./",T=function(e,t){return!t||t.length===0?e():Promise.all(t.map(o=>{if(o=`${R}${o}`,o in g)return;g[o]=!0;const s=o.endsWith(".css"),n=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${n}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":C,s||(a.as="script",a.crossOrigin=""),a.href=o,document.head.appendChild(a),s)return new Promise((w,E)=>{a.addEventListener("load",w),a.addEventListener("error",E)})})).then(()=>e())};const h={GH_REPO_URL:"/movies",API_KEY:"8c8e1a50-6322-4135-8875-5d40a5420d86",API_BASE:"https://kinopoiskapiunofficial.tech"},l=r=>h.GH_REPO_URL+r;const i=S,u=P,m=A;var O=r=>u(v,{class:L("card",{[r.class]:!!r.class}),href:r.url,children:[i("div",{class:"card-img",style:`background-image: url(${r.image})`}),i("div",{class:"card-title",children:r.title}),i("div",{class:"card-desc",children:r.description})]});class D extends y{constructor(e){super(e);c(this,"state");c(this,"refInput",$());c(this,"timeout",0);c(this,"page",1);this.state={movies:[]},this.handleInput=this.handleInput.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleInput(e){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.handleSubmit(e)},1e3)}handleSubmit(e){clearTimeout(this.timeout),e.preventDefault(),this.searchMovieByName(this.refInput.current.value)}async api(e){const t=await fetch(h.API_BASE+e,{method:"GET",headers:{"Content-Type":"application/json","X-API-KEY":h.API_KEY}});let o=null;try{if(!t.ok)throw new Error("Invalid status");let{films:s}=await t.json();o=s.map(n=>({title:n.nameRu,description:n.year,url:`/movies/${n.filmId}`,image:n.posterUrlPreview}))}catch(s){console.error(s);return}return o}async searchMovieByName(e){const t=await this.api(`/api/v2.1/films/search-by-keyword?keyword=${e}`);this.setState({movies:t}),this.page=1}async searchMovieTop(e){const t=await this.api(`/api/v2.2/films/top?type=TOP_250_BEST_FILMS&page=${e}`);return t.length?(this.setState({movies:[...this.state.movies,...t]}),!1):!0}componentDidMount(){let e=!1;const t=async()=>{await this.searchMovieTop(this.page++)||(e=!1)};window.onscroll=async o=>{e||window.innerHeight+window.scrollY>=document.body.offsetHeight-120&&(t(),e=!0)},t()}componentWillUnmount(){}render(){return u(m,{children:[i("form",{class:"home-search",onSubmit:this.handleSubmit,children:u("label",{class:"home-label",children:[i("input",{class:"home-input",type:"text",name:"search",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0444\u0438\u043B\u044C\u043C\u0430 ...",onInput:this.handleInput,ref:this.refInput}),i("svg",{class:"home-icon",width:"24",height:"24",children:i("use",{xlinkHref:"#icon-search"})})]})}),i("div",{class:"cards",children:i("div",{class:"cards-wrapper",children:this.state.movies.map(e=>i(O,p({class:"cards-item"},e)))})})]})}}class F extends y{render(){return i(m,{children:i("div",{class:"error",children:"404"})})}}function H(){return u(m,{children:[i("header",{class:"header",children:u("div",{class:"container",children:[i(v,{class:"header-logo",href:l("/"),children:"movies"}),i("div",{class:"header-desc",children:"\u0441\u043C\u043E\u0442\u0440\u0438\u0442\u0435 \u0444\u0438\u043B\u044C\u043C\u044B \u043E\u043D\u043B\u0430\u0439\u043D, \u0431\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E"})]})}),i("div",{class:"content container",children:u(k,{children:[i(D,{path:l("/"),default:!0}),i(F,{path:l("/error")}),i(B,{path:l("/:id"),getComponent:()=>T(()=>import("./movies.5ac0fec5.js"),["assets/movies.5ac0fec5.js","assets/movies.be846550.css","assets/vendor.c8f8949d.js"]).then(r=>r.default),loading:()=>i("span",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 ..."})})]})})]})}j(i(H,{}),document.getElementById("app"));export{m as F,i as a,u as j,l as r};
