var w=Object.defineProperty;var m=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var d=(s,e,t)=>e in s?w(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,f=(s,e)=>{for(var t in e||(e={}))E.call(e,t)&&d(s,t,e[t]);if(m)for(var t of m(e))I.call(e,t)&&d(s,t,e[t]);return s};var l=(s,e,t)=>(d(s,typeof e!="symbol"?e+"":e,t),t);import{j as b,a as S,F as _,L as p,c as $,_ as v,p as P,R as A,A as B,S as k}from"./vendor.4f1139c9.js";const L=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerpolicy&&(n.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?n.credentials="include":r.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}};L();const T="modulepreload",y={},j="./",x=function(e,t){return!t||t.length===0?e():Promise.all(t.map(o=>{if(o=`${j}${o}`,o in y)return;y[o]=!0;const r=o.endsWith(".css"),n=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${n}`))return;const a=document.createElement("link");if(a.rel=r?"stylesheet":T,r||(a.as="script",a.crossOrigin=""),a.href=o,document.head.appendChild(a),r)return new Promise((u,g)=>{a.addEventListener("load",u),a.addEventListener("error",g)})})).then(()=>e())};const i=b,c=S,h=_;var C=s=>c(p,{class:$("card",{[s.class]:!!s.class}),href:s.url,children:[i("div",{class:"card-img",style:`background-image: url(${s.image})`}),i("div",{class:"card-title",children:s.title}),i("div",{class:"card-desc",children:s.description})]});class D extends v{constructor(e){super(e);l(this,"state");l(this,"refInput",P());l(this,"timeout",0);l(this,"page",1);this.state={movies:[]},this.handleInput=this.handleInput.bind(this),this.handleSubmit=this.handleSubmit.bind(this)}handleInput(e){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.handleSubmit(e)},1e3)}handleSubmit(e){clearTimeout(this.timeout),e.preventDefault(),this.searchMovieByName(this.refInput.current.value)}async api(e){const t="8c8e1a50-6322-4135-8875-5d40a5420d86",r=await fetch("https://kinopoiskapiunofficial.tech"+e,{method:"GET",headers:{"Content-Type":"application/json","X-API-KEY":t}});let n=null;try{if(!r.ok)throw new Error("Invalid status");let{films:a}=await r.json();n=a.map(u=>({title:u.nameRu,description:u.year,url:`/movies/${u.filmId}`,image:u.posterUrlPreview}))}catch(a){console.error(a);return}return n}async searchMovieByName(e){const t=await this.api(`/api/v2.1/films/search-by-keyword?keyword=${e}`);this.setState({movies:t}),this.page=1}async searchMovieTop(e){const t=await this.api(`/api/v2.2/films/top?type=TOP_250_BEST_FILMS&page=${e}`);return t.length?(this.setState({movies:[...this.state.movies,...t]}),!1):!0}componentDidMount(){let e=!1;const t=async()=>{await this.searchMovieTop(this.page++)||(e=!1)};window.onscroll=async o=>{e||window.innerHeight+window.scrollY>=document.body.offsetHeight-120&&(t(),e=!0)},t()}componentWillUnmount(){}render(){return c(h,{children:[i("form",{class:"home-search",onSubmit:this.handleSubmit,children:c("label",{class:"home-label",children:[i("input",{class:"home-input",type:"text",name:"search",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0444\u0438\u043B\u044C\u043C\u0430 ...",onInput:this.handleInput,ref:this.refInput}),i("svg",{class:"home-icon",width:"24",height:"24",children:i("use",{xlinkHref:"#icon-search"})})]})}),i("div",{class:"cards",children:i("div",{class:"cards-wrapper",children:this.state.movies.map(e=>i(C,f({class:"cards-item"},e)))})})]})}}class O extends v{render(){return i(h,{children:i("div",{class:"error",children:"404"})})}}function F(){const s="/movies";return c(h,{children:[i("header",{class:"header",children:c("div",{class:"container",children:[i(p,{class:"header-logo",href:"/",children:"movies"}),i("div",{class:"header-desc",children:"\u0441\u043C\u043E\u0442\u0440\u0438\u0442\u0435 \u0444\u0438\u043B\u044C\u043C\u044B \u043E\u043D\u043B\u0430\u0439\u043D, \u0431\u0435\u0441\u043F\u043B\u0430\u0442\u043D\u043E"})]})}),i("div",{class:"content container",children:c(A,{children:[i(D,{path:`${s}/`}),i(B,{path:`${s}/:id`,getComponent:()=>x(()=>import("./movies.e3383fba.js"),["assets/movies.e3383fba.js","assets/movies.be846550.css","assets/vendor.4f1139c9.js"]).then(e=>e.default),loading:()=>i("span",{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 ..."})}),i(O,{path:"*",default:!0})]})})]})}k(i(F,{}),document.getElementById("app"));export{h as F,i as a,c as j};
